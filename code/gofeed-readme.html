<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gofeed 说明文档 - 小V吃鱼卡到了</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="http://www.zhuimengle.com/theme/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="http://www.zhuimengle.com/theme/font-awesome/css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="http://www.zhuimengle.com/theme/css/niu2.min.css" type="text/css" />

    <link rel="canonical" href="http://www.zhuimengle.com/code/gofeed-readme.html" />
    
    <script type="text/javascript">window.onload=function(){};</script>
    <!--[if lt IE 9]>
        <script src="http://www.zhuimengle.com/theme/js/html5shiv.js"></script>
        <script src="http://www.zhuimengle.com/theme/js/respond.min.js"></script>
    <![endif]-->
  </head>
  <body> 
    <div id="body-header">
<div class="navbar navbar-inverse navbar-fixed-top">
<div class="col-md-12">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.zhuimengle.com">
            <i class="fa fa-home"></i>小V吃鱼卡到了
        </a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
        <ul class="nav navbar-nav">
            <li><a href="/about.html" title="about me">
                <i class="fa fa-anchor"></i>关于</a>
            </li>
            <li><a href="/agreement.html" title="agreement">
                <i class="fa fa-info-circle"></i>使用协议</a>
            </li>
            <li><a href="/my_projects.html" title="my projects">
                <i class="fa fa-rocket"></i>项目</a>
            </li>
            <li><a href="/archives.html" title="blog archives">
                <i class="fa fa-archive"></i>存档</a>
            </li>
            <li><a href="/tag/" title="blog tags">
                <i class="fa fa-tag"></i>标签</a>
            </li>
        <!-- category dropdown list -->
        <li class="dropdown">
           <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <i class="fa fa-folder-open"></i>分类<b class="caret"></b>
           </a>
           <ul class="dropdown-menu">
               <li><a href="http://www.zhuimengle.com/code/index.html">
                      <i class="fa fa-code"></i>代码
                      (2)</a></li>
               <li><a href="http://www.zhuimengle.com/collection/index.html">
                      <i class="fa fa-briefcase"></i>搜藏
                      (6)</a></li>
               <li><a href="http://www.zhuimengle.com/essay/index.html">
                      <i class="fa fa-leaf"></i>随笔
                      (7)</a></li>
               <li><a href="http://www.zhuimengle.com/life/index.html">
                      <i class="fa fa-coffee"></i>日常
                      (8)</a></li>
               <li><a href="http://www.zhuimengle.com/note/index.html">
                      <i class="fa fa-book"></i>笔记
                      (2)</a></li>
               <li><a href="http://www.zhuimengle.com/research/index.html">
                      <i class="fa fa-flask"></i>研究
                      (2)</a></li>
           </ul>
        </li>
        <!--  self defined dropdown list -->
        </ul>
        
        <!-- right nav bar -->
        <ul class="nav navbar-nav navbar-right">
        <!-- google custom search -->
       </ul>
    </nav>
</div>
</div>    </div>
    
    <div id="body-content">
<div class="col-md-8 col-md-offset-2">
    <h1 id="content-heading">Gofeed 说明文档</h1>
</div>
<div id="niu2-left-container" class="col-md-6 col-md-offset-2 with-right-border">
    <div id="niu2-main-content">
        <p>Gofeed was inspired by feed43.com. It is disigned to extract full-text feeds from websites which only provide partial feeds or provide no feeds at all.</p>
<p>This simple program was written when I started to learn golang. So I tried to reinvent everything I need, including a simple crawler which took good use of cache and a very simple rss2.0 feed generator.</p>
<h2 id="d50ae403cb49a205bdf789f377f5cfe6">Releases</h2>
<p>See <a href="http://dl.atime.me/gofeed">http://dl.atime.me/gofeed</a>.</p>
<h2 id="98f770b0af18ca763421bac22b4b6805">Features</h2>
<ul>
<li>Like feed43.com, you can extract feed titles, feed links and the feed descriptions from web pages or partial feeds with some predefined patterns and even your custom regular expressions. </li>
<li>The crawler knows well when to request new html and when to use local html cache. This will save a lot of bandwidth.</li>
</ul>
<h2 id="b82244f53386cd3e3e5f8c6410975db0">Things need to be improved</h2>
<ul>
<li>Little documentation.</li>
<li>No enough tests(use coveralls.io coverage service).</li>
<li>Maybe more...</li>
</ul>
<h2 id="5305c4890ee29a5e7560f14a001a7e12">More functions on the todo list</h2>
<ol>
<li><del>Cache old requests: use sqlite to cache downloaded web pages and save their lastmod time.</del></li>
<li><del>Download html files for each feed target defined in the configuration in separate goroutines. </del></li>
<li><del>Add debug mode, which will print more debug infomation</del></li>
<li>Add alternative methods to extract feed title, link and description from html<ol>
<li>xpath</li>
</ol>
</li>
</ol>
<h2 id="349838fb1d851d3e2014b9fe39203275">Install</h2>
<p>Firstly, make sure you have set the <code>GOPATH</code> environment variable properly. Then, you should install the sqlite driver <code>go-sqlite3</code>.</p>
<div class="codehilite"><pre>go get github.com/mattn/go-sqlite3
</pre></div>


<p>Now install gofeed.</p>
<div class="codehilite"><pre>go get github.com/mawenbao/gofeed
</pre></div>


<h2 id="e748420f41e5cba4a0408c1b11df005b">Configuration example</h2>
<h3 id="3079d95c7368573e2299a9f703b9172b">Json configuration</h3>
<p>See <code>example_config.json</code> and <code>example_config2.json</code>.</p>
<ul>
<li>CacheDB: (string) path of html cache database(sqlite3), can be absolute or be relative to the current directory.</li>
<li>CacheLifetime: (string) cache will be removed from cache database after CacheLifetime, "", "5d", "3h", "10m", "1s" and "5d3h10m" are acceptable where "" means cache lives forever in the cache database.</li>
<li>Targets: array of feed targets, each of which runs in a separate goroutine<ul>
<li>Request.Interval: (integer) time to wait before sending a http request to the target.</li>
<li>Feed.Path: (string) output path of the rss2 feed file, can be relative or absolute.</li>
<li>Feed.Title: (string) title of the rss2 feed channel. If not defined, feed title will be the filename of Feed.Path.</li>
<li>Feed.Description: (string) description of the rss2 feed channel. In not defined, feed description will be empty.</li>
<li>Feed.URL: (array of strings) array of urls, used to define urls of the target's index pages. Note that this url can be html or xml or anything that you can extract feed entry titles and links with regex patterns.</li>
<li>Feed.IndexFilterPattern: (array of strings) array of index filter patterns, used to filter valid index html from the entire html.</li>
<li>Feed.IndexPattern: (array of strings) array of index patterns, used to extract entry link and entry title from the filtered content by Feed.IndexFilterPattern.</li>
<li>Feed.ContentFilterPattern: (array of strings) array of content patterns, used to extract valid content html from the entire html identified by {link}.</li>
<li>Feed.ContentPattern: (array of strings) array of content patterns, used to extract entry description from the entry's filtered html content by Feed.ContentFilterPattern.</li>
<li>Feed.PubDatePattern: (string) pattern of publish date, see pre-defined patterns. Used to extract publish date of an article from the string extracted from {pubdate} pattern.</li>
</ul>
</li>
</ul>
<p>And you should note that</p>
<ol>
<li>
<p>There should be as many Feed.URL as Feed.IndexPattern. If array length of the two does not match, there should be only one Feed.IndexPattern or only one Feed.URL, which means all the Feed.URL will share the same Feed.IndexPattern or all the Feed.IndexPattern share the same Feed.URL. Otherwise, an configuration parse error will return. </p>
</li>
<li>
<p>For Feed.ContentPattern, there should be as many Feed.URL as Feed.ContentPattern. If array length of the two does not match, there should be only one Feed.ContentPattern, which means all the Feed.URL will share the same Feed.ContentPattern. And the same goes for Feed.PubDateFormat.</p>
</li>
<li>
<p>Either Feed.IndexPattern or Feed.ContentPattern can contain the {pubdate} pattern, but not both.</p>
</li>
</ol>
<h3 id="ebbca9ab0c1cbffbf2d72c2fbe21b08c">Pre-defined patterns</h3>
<p>You can use the following predefined patterns in <code>Feed.IndexPattern</code> and <code>Feed.ContentPattern</code> of the json configuration. Note that all these patterns are <strong>lazy</strong> and perform <strong>leftmost</strong> match, which means they will match as few characters as possible.</p>
<ul>
<li>{any}: match any character including newline</li>
<li>{title}: title of feed entry, matched against the Feed.URL page</li>
<li>{link}: hyper link of feed entry, matched against the Feed.URL page</li>
<li>{description}: full-text description of feed entry, matched against the corresponding {link} page</li>
<li>{pubdate}: publish date of feed entry</li>
<li>{filter}: filtered content, used in Feed.IndexFilterPattern or Feed.ContentFilterPattern</li>
</ul>
<p>Date time format pattern, currently used for publish date string extraced from the {pubdate} pattern:</p>
<ul>
<li>{year}: must be an integer</li>
<li>{month}: must be an integer, Jan or January.</li>
<li>{day}: must be an integer</li>
<li>{hour}: must be an integer</li>
<li>{minute}: must be an integer</li>
<li>{second}: must be an integer</li>
</ul>
<h3 id="5f6de3be76ecf740dffc06c781345556">Custom regular expressions</h3>
<p>You can also write custom regex in <code>Feed.IndexPattern</code> and <code>Feed.ContentPattern</code>. Make sure there are no predefined patterns in your custom regular expressions. The regex syntax documentation can be found <a href="https://code.google.com/p/re2/wiki/Syntax">here</a>.</p>
<p>The custom regular expressions have not been tested properly. So I suggest just using the predefined patterns.</p>
<h2 id="a53e149cec1eac59b14e1efc1d6b620f">Command line options</h2>
<div class="codehilite"><pre>Usage ./gofeed [-version][-v][-d][-c cpu_number][-l log_file][-k][-z compression_level] json_config_file

Flags:
-a=false: use cache if failed to download web page
-c=2: number of cpus to run simultaneously
-v=false: be verbose
-d=false: debug mode
-l=&quot;&quot;: path of the log file
-k=false: keep feed entries which do not have any description
-z=9: compression level when saving html cache with gzip in the cache database.
    0-9 acceptable where 0 means no compression
-version=false: print gofeed version
</pre></div>


<ul>
<li>-a: If failed to download the target url, try to use cache even it has expired.</li>
<li>-c: Number of cpus, default value is the actual number of your machine's cpus.</li>
<li>-v: Print more infomation.</li>
<li>-d: Print even more information than <code>-v</code> option, should be useful when debugging your index or content patterns.</li>
<li>-l: Append output in a log file</li>
<li>-z: Gofeed compresses html cache data with gzip by default. This option can set compression level of gzip, however, you can pass 0 to disable compression.</li>
<li>-version: Print gofeed version</li>
</ul>
<h2 id="794df3791a8c800841516007427a2aa3">License</h2>
<p>BSD license, see LICENSE.txt for more details.</p>
    </div>
    <div id="content-comments">
<div id="disqus_thread"></div>
<script type="text/javascript">var disqus_shortname="vic-story";(function(){var a=document.createElement("script");a.type="text/javascript";a.async=true;a.src="//"+disqus_shortname+".disqus.com/embed.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)})();</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

</div>
<div class="niu2-right-container col-md-2">
    <div id="niu2-sidebar-meta" class="niu2-sidebar">
        <div class="niu2-sidebar-label"><i class="fa fa-calendar"></i>发布时间:</div>
        <div class="niu2-sidebar-value">2013-11-28 11:04</div>
        <div class="niu2-sidebar-label"><i class="fa fa-pencil" style="font-size: 1.05em;"></i>最后修改:</div>
        <div class="niu2-sidebar-value">2014-03-17 15:11</div>
        <div class="niu2-sidebar-label"><i class="fa fa-code"></i>分类:</div>
        <div class="niu2-sidebar-value"><a href="http://www.zhuimengle.com/code/index.html">代码</a></div>
        <div class="niu2-sidebar-label"><i class="fa fa-tag"></i>标签:</div>
 
            <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://www.zhuimengle.com/tag/doc.html">doc</a><sup>2</sup></div>
            <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://www.zhuimengle.com/tag/golang.html">golang</a><sup>2</sup></div>
            <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://www.zhuimengle.com/tag/feed.html">feed</a><sup>1</sup></div>
            <div class="niu2-sidebar-inter-value niu2-sidebar-tag"><a href="http://www.zhuimengle.com/tag/rss.html">rss</a><sup>1</sup></div>
    </div>
</div>

<div class="niu2-right-container col-md-3">
    <div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
        <div class="niu2-sidebar-label">
            <i id="niu2-sidebar-toc-ctrl" class="fa fa-plus"></i>目录
        </div>
        <ol id="niu2-sidebar-toc-list">
            <li><a href="#content-heading">Gofeed 说明文档</a></li>
            <li><a href='#d50ae403cb49a205bdf789f377f5cfe6'>Releases</a></li><li><a href='#98f770b0af18ca763421bac22b4b6805'>Features</a></li><li><a href='#b82244f53386cd3e3e5f8c6410975db0'>Things need to be improved</a></li><li><a href='#5305c4890ee29a5e7560f14a001a7e12'>More functions on the todo list</a></li><li><a href='#349838fb1d851d3e2014b9fe39203275'>Install</a></li><li><a href='#e748420f41e5cba4a0408c1b11df005b'>Configuration example</a><ol><li><a href='#3079d95c7368573e2299a9f703b9172b'>Json configuration</a></li><li><a href='#ebbca9ab0c1cbffbf2d72c2fbe21b08c'>Pre-defined patterns</a></li><li><a href='#5f6de3be76ecf740dffc06c781345556'>Custom regular expressions</a></li></ol></li><li><a href='#a53e149cec1eac59b14e1efc1d6b620f'>Command line options</a></li><li><a href='#794df3791a8c800841516007427a2aa3'>License</a></li>
            <li><a href="#content-comments">评论</a></li>
        </ol>
    </div>
</div>
    </div>

    <div id="body-footer" class="col-md-6 col-md-offset-2">
<div class="niu2-footer">
    <hr/>
	<p>
		Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>, 
        <a href="https://github.com/mawenbao/niu-x2-sidebar">theme</a> built with <a href="http://getbootstrap.com">Bootstrap3</a>
		by <a href="http://blog.atime.me">Ma Wenbao</a>, icons by 
		<a href="http://fortawesome.github.io/Font-Awesome">Font Awesome</a>.
	</p>
	<p>
		©
				2009-2014
		<a class="niu2-footer-link" href="http://www.zhuimengle.com">vk</a>
        / 			<a class="niu2-footer-link" href="/about.html" title="about me">About</a>
        / 			<a class="niu2-footer-link" href="/agreement.html" title="terms, license and privacy etc.">Agreement</a>
    </p>
    <p class="niu2-icons">
	        <a class="niu2-footer-icon" href="/my_gnupg.html" title="my public key">
	            <i class="fa fa-key fa-lg"></i>
	        </a>
	        <a class="niu2-footer-icon" href="mailto: mawenbao@hotmail.com" title="my email address">
	            <i class="fa fa-envelope-o fa-lg"></i>
	        </a>
	        <a class="niu2-footer-icon" href="http://github.com/mawenbao" title="my github page">
	            <i class="fa fa-github-alt fa-lg"></i>
	        </a>
	        <a class="niu2-footer-icon" href="/feed.xml" title="subscribe my blog">
	            <i class="fa fa-rss fa-lg"></i>
	        </a>
	</p>
</div>    </div>
    
    <div id="niu2-pygments" data-theme="github"></div>

    <script type="text/javascript" src="http://www.zhuimengle.com/theme/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="http://www.zhuimengle.com/theme/js/niu2.min.js"></script>
    <script type="text/javascript" src="http://www.zhuimengle.com/theme/js/bootstrap.min.js"></script>
    <script type="text/javascript">onContentLoaded();</script>
  </body>
</html>